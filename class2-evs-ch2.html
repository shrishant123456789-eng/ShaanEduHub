<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üå± Class 2 EVS ‚Äì Chapter 2: Food & Nutrition</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Comic+Neue:wght@400;700&family=Pacifico&family=Patrick+Hand&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #FF6B6B;
            --secondary-color: #4ECDC4;
            --accent-color: #FFE66D;
            --text-dark: #2C3E50;
            --text-light: #ffffff;
            --success: #2ecc71;
            --error: #e74c3c;
            --bg-gradient: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
        }

        * { box-sizing: border-box; user-select: none; }

        body {
            font-family: 'Comic Neue', cursive;
            background: var(--bg-gradient);
            margin: 0;
            padding: 0;
            color: var(--text-dark);
        }

        /* --- Header --- */
        header {
            background: linear-gradient(to right, #FF9966, #FF5E62);
            padding: 20px;
            text-align: center;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            position: relative;
            overflow: hidden;
        }

        h1 {
            font-family: 'Fredoka One', cursive;
            margin: 0;
            font-size: 2rem;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
            letter-spacing: 1px;
        }

        .header-emojis span {
            font-size: 2rem;
            animation: bounce 2s infinite;
            display: inline-block;
            margin: 0 5px;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* --- Layout --- */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* --- Section 1: Detailed Notes --- */
        .notes-section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border: 3px solid var(--secondary-color);
        }

        .section-title {
            font-family: 'Fredoka One', cursive;
            color: var(--primary-color);
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .cursive-text {
            font-family: 'Patrick Hand', cursive; /* Readable cursive */
            font-size: 1.3rem;
            line-height: 1.6;
            color: #444;
        }

        .accordion {
            background-color: #f1f8ff;
            color: #444;
            cursor: pointer;
            padding: 15px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 1.2rem;
            font-family: 'Fredoka One', cursive;
            transition: 0.4s;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .active, .accordion:hover {
            background-color: var(--secondary-color);
            color: white;
        }

        .panel {
            padding: 0 18px;
            background-color: white;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.2s ease-out;
            border-left: 3px solid var(--secondary-color);
            margin-bottom: 10px;
        }

        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            text-align: center;
            margin-top: 10px;
        }

        .food-item {
            background: #fff;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        .food-item:hover { transform: scale(1.05); }
        .food-icon { font-size: 2.5rem; }

        .tooltip {
            position: relative;
            display: inline-block;
            border-bottom: 2px dashed var(--primary-color);
            cursor: help;
            color: var(--primary-color);
            font-weight: bold;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-family: 'Comic Neue';
            font-size: 1rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* --- Section 2: Interactive Exercises --- */
        .game-section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            border: 3px solid var(--primary-color);
            text-align: center;
        }

        .score-board {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .level-selector {
            margin-bottom: 20px;
        }

        .level-btn {
            padding: 10px 20px;
            font-family: 'Fredoka One';
            border: none;
            border-radius: 20px;
            margin: 5px;
            cursor: pointer;
            background: #ddd;
            transition: 0.3s;
        }

        .level-btn.active-level {
            background: var(--primary-color);
            color: white;
            transform: scale(1.1);
        }

        .question-card {
            background: #f1f8ff;
            padding: 20px;
            border-radius: 15px;
            min-height: 200px;
            position: relative;
        }

        .audio-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #FFD93D;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .q-text {
            font-size: 1.5rem;
            margin: 20px 0;
            font-weight: bold;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .option-btn {
            background: white;
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Comic Neue';
            font-size: 1.2rem;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .option-btn:hover {
            border-color: var(--secondary-color);
            background: #eefcfb;
        }
        
        .option-emoji { font-size: 2rem; display: block; margin-bottom: 5px; }

        .feedback-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            z-index: 1000;
            text-align: center;
            display: none;
            border: 5px solid;
        }
        
        .overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .feedback-emoji { font-size: 4rem; display: block; margin-bottom: 10px; }
        .next-btn {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 25px;
            font-size: 1.2rem;
            border-radius: 20px;
            cursor: pointer;
            margin-top: 15px;
            font-family: 'Fredoka One';
        }

        /* --- Footer --- */
        footer {
            background: #2C3E50;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            border-top-left-radius: 30px;
            border-top-right-radius: 30px;
        }
        
        .footer-link { color: var(--secondary-color); text-decoration: none; font-weight: bold; }

        /* Responsive */
        @media (max-width: 600px) {
            h1 { font-size: 1.5rem; }
            .option-btn { font-size: 1rem; }
        }
    </style>
</head>
<body>

<header>
    <h1>üå± Class 2 EVS <br> Chapter 2: Food & Nutrition</h1>
    <div class="header-emojis">
        <span>üçé</span><span>ü•¶</span><span>üçû</span><span>ü•õ</span><span>üç≥</span>
    </div>
</header>

<main class="container">

    <section class="notes-section">
        <h2 class="section-title">üìö Let's Learn! (Notes)</h2>
        
        <button class="accordion">1. Types of Food üç≤</button>
        <div class="panel cursive-text">
            <p>Food gives us energy to work and play. It helps us grow!</p>
            <div class="food-grid">
                <div class="food-item"><span class="food-icon">üçé</span><br><strong>Fruits</strong><br>Vitamins & Energy</div>
                <div class="food-item"><span class="food-icon">ü•¶</span><br><strong>Vegetables</strong><br>Keep us healthy</div>
                <div class="food-item"><span class="food-icon">üçö</span><br><strong>Grains</strong><br>Rice, Wheat, Corn</div>
                <div class="food-item"><span class="food-icon">ü•õ</span><br><strong>Dairy</strong><br>Milk for bones</div>
            </div>
            <p><strong>Pulses (Dal):</strong> Lentils and beans give us muscles!</p>
        </div>

        <button class="accordion">2. The Balanced Diet ‚öñÔ∏è</button>
        <div class="panel cursive-text">
            <p>A balanced diet means eating a little bit of everything!</p>
            <ul>
                <li>Some <span class="tooltip">Energy Food<span class="tooltiptext">Like Bread and Rice!</span></span> (Grains)</li>
                <li>Some <span class="tooltip">Body Building Food<span class="tooltiptext">Like Eggs and Dal!</span></span> (Proteins)</li>
                <li>Some <span class="tooltip">Protective Food<span class="tooltiptext">Like Fruits and Veggies!</span></span> (Vitamins)</li>
            </ul>
        </div>

        <button class="accordion">3. Healthy vs Junk Food üçî</button>
        <div class="panel cursive-text">
            <p><strong>‚úÖ Healthy:</strong> Fruits, Salad, Milk, Roti. (Gives strength!)</p>
            <p><strong>‚ùå Junk:</strong> Chips, Candy, Soda, too much Burger. (Makes us lazy and sick!)</p>
        </div>

        <button class="accordion">4. Water & Vitamins üíß</button>
        <div class="panel cursive-text">
            <p>We must drink <strong>6‚Äì8 glasses</strong> of water every day!</p>
            <p><strong>Vitamin Secrets:</strong></p>
            <ul>
                <li>ü•ï Carrots (Vit A) = Good Eyes</li>
                <li>ü•õ Milk (Calcium) = Strong Bones</li>
                <li>ü•¨ Spinach (Iron) = Strong Blood</li>
                <li>üçä Orange (Vit C) = No Colds!</li>
            </ul>
        </div>

        <button class="accordion">5. Good Eating Habits üçΩÔ∏è</button>
        <div class="panel cursive-text">
            <ol>
                <li>Wash hands before eating. üßº</li>
                <li>Chew food slowly. üò¨</li>
                <li>Do not talk while eating. ü§´</li>
                <li>Do not waste food. üö´</li>
            </ol>
        </div>
    </section>

    <section class="game-section" id="exercise-area">
        <h2 class="section-title">üéÆ Fun Exercises</h2>
        
        <div class="score-board">
            <span>‚≠ê Stars: <span id="star-count">0</span></span>
            <span>‚úÖ Score: <span id="score">0</span></span>
            <span>üìù Left: <span id="q-left">50</span></span>
        </div>

        <div class="level-selector">
            <button class="level-btn active-level" onclick="setLevel(1)">Level 1 (Basic)</button>
            <button class="level-btn" onclick="setLevel(2)">Level 2 (Smart)</button>
            <button class="level-btn" onclick="setLevel(3)">Level 3 (Genius)</button>
        </div>

        <div class="question-card" id="question-container">
            <button class="audio-btn" onclick="readQuestion()">üîä</button>
            <div id="q-image" style="font-size:3rem; margin-bottom:10px;"></div>
            <div class="q-text" id="q-text">Loading Question...</div>
            <div class="options-grid" id="options-area">
                </div>
        </div>
    </section>

</main>

<div class="overlay" id="overlay"></div>
<div class="feedback-modal" id="feedback-modal">
    <span class="feedback-emoji" id="fb-emoji">üéâ</span>
    <h2 id="fb-title">Correct!</h2>
    <p id="fb-msg">Great job!</p>
    <button class="next-btn" onclick="nextQuestion()">Next Question ‚û°</button>
</div>

<footer>
    <p>Designed & Created by <strong>SHRISHANT YADAV</strong></p>
    <p>¬© 2026 ShanEduHub | Class 2 EVS</p>
</footer>

<script>
    // --- Data: 50+ Questions ---
    const allQuestions = [
        // LEVEL 1: Basic (1-15)
        { id: 1, level: 1, type: 'img', q: "Tap the Fruit!", opts: [{t:"Apple", i:"üçé"}, {t:"Carrot", i:"ü•ï"}, {t:"Bread", i:"üçû"}], ans: "Apple" },
        { id: 2, level: 1, type: 'img', q: "Tap the Vegetable!", opts: [{t:"Banana", i:"üçå"}, {t:"Broccoli", i:"ü•¶"}, {t:"Egg", i:"ü•ö"}], ans: "Broccoli" },
        { id: 3, level: 1, type: 'mcq', q: "Milk is a ___ product.", opts: [{t:"Dairy", i:"ü•õ"}, {t:"Grain", i:"üåæ"}, {t:"Meat", i:"üçó"}], ans: "Dairy" },
        { id: 4, level: 1, type: 'tf', q: "Apple is a vegetable.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "False" },
        { id: 5, level: 1, type: 'img', q: "Which one gives protein?", opts: [{t:"Candy", i:"üç¨"}, {t:"Beans", i:"ü´ò"}, {t:"Water", i:"üíß"}], ans: "Beans" },
        { id: 6, level: 1, type: 'img', q: "Identify the Junk Food.", opts: [{t:"Chips", i:"üçü"}, {t:"Apple", i:"üçé"}, {t:"Rice", i:"üçö"}], ans: "Chips" },
        { id: 7, level: 1, type: 'mcq', q: "We eat breakfast in the...", opts: [{t:"Morning", i:"üåÖ"}, {t:"Night", i:"üåÉ"}], ans: "Morning" },
        { id: 8, level: 1, type: 'img', q: "Select the drink.", opts: [{t:"Bread", i:"üçû"}, {t:"Water", i:"ü•õ"}, {t:"Cake", i:"üç∞"}], ans: "Water" },
        { id: 9, level: 1, type: 'match', q: "Match: A for ___", opts: [{t:"Apple", i:"üçé"}, {t:"Banana", i:"üçå"}, {t:"Grapes", i:"üçá"}], ans: "Apple" },
        { id: 10, level: 1, type: 'match', q: "Match: C for ___", opts: [{t:"Carrot", i:"ü•ï"}, {t:"Tomato", i:"üçÖ"}, {t:"Potato", i:"ü•î"}], ans: "Carrot" },
        { id: 11, level: 1, type: 'tf', q: "Junk food makes us strong.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "False" },
        { id: 12, level: 1, type: 'mcq', q: "Rice is a...", opts: [{t:"Grain", i:"üåæ"}, {t:"Fruit", i:"üçé"}, {t:"Dairy", i:"üßÄ"}], ans: "Grain" },
        { id: 13, level: 1, type: 'img', q: "Tap the Egg.", opts: [{t:"Egg", i:"ü•ö"}, {t:"Ball", i:"‚öΩ"}, {t:"Moon", i:"üåï"}], ans: "Egg" },
        { id: 14, level: 1, type: 'mcq', q: "How many glasses of water daily?", opts: [{t:"1 glass", i:"ü•õ"}, {t:"6-8 glasses", i:"ü•õü•õ"}], ans: "6-8 glasses" },
        { id: 15, level: 1, type: 'img', q: "Which food is red?", opts: [{t:"Cucumber", i:"ü•í"}, {t:"Strawberry", i:"üçì"}, {t:"Lemon", i:"üçã"}], ans: "Strawberry" },

        // LEVEL 2: Intermediate (16-35)
        { id: 16, level: 2, type: 'mcq', q: "Carrots are good for your...", opts: [{t:"Eyes", i:"üëÄ"}, {t:"Hair", i:"üíá"}, {t:"Feet", i:"ü¶∂"}], ans: "Eyes" },
        { id: 17, level: 2, type: 'mcq', q: "Milk makes our ___ strong.", opts: [{t:"Bones", i:"ü¶¥"}, {t:"Nose", i:"üëÉ"}], ans: "Bones" },
        { id: 18, level: 2, type: 'img', q: "Which contains Vitamin C?", opts: [{t:"Orange", i:"üçä"}, {t:"Bread", i:"üçû"}, {t:"Chicken", i:"üçó"}], ans: "Orange" },
        { id: 19, level: 2, type: 'mcq', q: "Spinach is rich in...", opts: [{t:"Iron", i:"üí™"}, {t:"Sugar", i:"üç¨"}], ans: "Iron" },
        { id: 20, level: 2, type: 'tf', q: "Balanced diet keeps us healthy.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "True" },
        { id: 21, level: 2, type: 'img', q: "Select Healthy Snack.", opts: [{t:"Nuts", i:"ü•ú"}, {t:"Candy", i:"üç¨"}, {t:"Cake", i:"üéÇ"}], ans: "Nuts" },
        { id: 22, level: 2, type: 'mcq', q: "Vegetables help us to...", opts: [{t:"Grow", i:"üìà"}, {t:"Sleep", i:"üò¥"}], ans: "Grow" },
        { id: 23, level: 2, type: 'mcq', q: "Which is a 'Body Building' food?", opts: [{t:"Dal/Pulses", i:"ü•ò"}, {t:"Candy", i:"üç¨"}], ans: "Dal/Pulses" },
        { id: 24, level: 2, type: 'tf', q: "Eating too much candy is good.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "False" },
        { id: 25, level: 2, type: 'mcq', q: "We eat dinner at...", opts: [{t:"Night", i:"üåô"}, {t:"Morning", i:"‚òÄÔ∏è"}], ans: "Night" },
        { id: 26, level: 2, type: 'img', q: "Tap the source of Calcium.", opts: [{t:"Cheese", i:"üßÄ"}, {t:"Apple", i:"üçé"}, {t:"Tomato", i:"üçÖ"}], ans: "Cheese" },
        { id: 27, level: 2, type: 'mcq', q: "Which colour is a ripe Banana?", opts: [{t:"Yellow", i:"üü°"}, {t:"Blue", i:"üîµ"}], ans: "Yellow" },
        { id: 28, level: 2, type: 'mcq', q: "Fish gives us...", opts: [{t:"Protein", i:"üêü"}, {t:"Sugar", i:"üç¨"}], ans: "Protein" },
        { id: 29, level: 2, type: 'tf', q: "Water helps clean our body.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "True" },
        { id: 30, level: 2, type: 'img', q: "Which is cooked food?", opts: [{t:"Soup", i:"üç≤"}, {t:"Raw Apple", i:"üçé"}], ans: "Soup" },
        { id: 31, level: 2, type: 'mcq', q: "Grains give us...", opts: [{t:"Energy", i:"‚ö°"}, {t:"Sleep", i:"üò¥"}], ans: "Energy" },
        { id: 32, level: 2, type: 'mcq', q: "Yogurt (Curd) comes from...", opts: [{t:"Milk", i:"ü•õ"}, {t:"Trees", i:"üå≥"}], ans: "Milk" },
        { id: 33, level: 2, type: 'mcq', q: "Papaya is a...", opts: [{t:"Fruit", i:"üçà"}, {t:"Vegetable", i:"ü•¶"}], ans: "Fruit" },
        { id: 34, level: 2, type: 'tf', q: "Ice cream is a main meal.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "False" },
        { id: 35, level: 2, type: 'mcq', q: "Tomatoes are...", opts: [{t:"Red", i:"üî¥"}, {t:"Blue", i:"üîµ"}], ans: "Red" },

        // LEVEL 3: Advanced (36-50+)
        { id: 36, level: 3, type: 'mcq', q: "What should we do before eating?", opts: [{t:"Wash Hands", i:"üßº"}, {t:"Play", i:"üéÆ"}], ans: "Wash Hands" },
        { id: 37, level: 3, type: 'mcq', q: "How should we sit while eating?", opts: [{t:"Properly", i:"ü™ë"}, {t:"Lying down", i:"üõå"}], ans: "Properly" },
        { id: 38, level: 3, type: 'mcq', q: "To keep teeth healthy, we...", opts: [{t:"Brush", i:"ü™•"}, {t:"Eat candy", i:"üç¨"}], ans: "Brush" },
        { id: 39, level: 3, type: 'tf', q: "Skipping breakfast is healthy.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "False" },
        { id: 40, level: 3, type: 'mcq', q: "Which habit is BAD?", opts: [{t:"Wasting Food", i:"üóëÔ∏è"}, {t:"Sharing Food", i:"ü§ù"}], ans: "Wasting Food" },
        { id: 41, level: 3, type: 'mcq', q: "We should eat our food...", opts: [{t:"Slowly", i:"üê¢"}, {t:"Fast", i:"üêá"}], ans: "Slowly" },
        { id: 42, level: 3, type: 'img', q: "Which is a 'complete' food for babies?", opts: [{t:"Milk", i:"ü•õ"}, {t:"Pizza", i:"üçï"}], ans: "Milk" },
        { id: 43, level: 3, type: 'mcq', q: "Why do we eat?", opts: [{t:"To live & grow", i:"üå±"}, {t:"Just for fun", i:"ü§°"}], ans: "To live & grow" },
        { id: 44, level: 3, type: 'mcq', q: "A sandwich has grain and...", opts: [{t:"Vegetables", i:"ü•ó"}, {t:"Chocolate", i:"üç´"}], ans: "Vegetables" },
        { id: 45, level: 3, type: 'tf', q: "We should talk while eating.", opts: [{t:"True", i:"üó£Ô∏è"}, {t:"False", i:"‚ùå"}], ans: "False" },
        { id: 46, level: 3, type: 'mcq', q: "Vitamin A helps us see in...", opts: [{t:"Dark", i:"üåë"}, {t:"Sun", i:"‚òÄÔ∏è"}], ans: "Dark" },
        { id: 47, level: 3, type: 'mcq', q: "Junk food makes us feel...", opts: [{t:"Lazy/Tired", i:"ü•±"}, {t:"Active", i:"üèÉ"}], ans: "Lazy/Tired" },
        { id: 48, level: 3, type: 'img', q: "Which activity needs energy from food?", opts: [{t:"Running", i:"üèÉ"}, {t:"Sitting", i:"ü™ë"}], ans: "Running" },
        { id: 49, level: 3, type: 'tf', q: "We should cover our food.", opts: [{t:"True", i:"‚úÖ"}, {t:"False", i:"‚ùå"}], ans: "True" },
        { id: 50, level: 3, type: 'mcq', q: "Which meal is in the afternoon?", opts: [{t:"Lunch", i:"üçõ"}, {t:"Dinner", i:"üç≤"}], ans: "Lunch" }
    ];

    // --- State Variables ---
    let currentLevel = 1;
    let currentQuestions = [];
    let currentQIndex = 0;
    let score = 0;
    let stars = 0;
    
    // --- Initialization ---
    document.addEventListener("DOMContentLoaded", () => {
        setupAccordions();
        setLevel(1);
    });

    // --- Logic ---

    function setupAccordions() {
        const acc = document.getElementsByClassName("accordion");
        for (let i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function() {
                this.classList.toggle("active");
                const panel = this.nextElementSibling;
                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                } else {
                    panel.style.maxHeight = panel.scrollHeight + "px";
                }
            });
        }
    }

    function setLevel(lvl) {
        currentLevel = lvl;
        // Visual Update for buttons
        document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active-level'));
        document.querySelectorAll('.level-btn')[lvl-1].classList.add('active-level');
        
        // Filter Questions and Shuffle
        currentQuestions = allQuestions.filter(q => q.level === lvl).sort(() => Math.random() - 0.5);
        currentQIndex = 0;
        
        updateUI();
        loadQuestion();
    }

    function loadQuestion() {
        if (currentQIndex >= currentQuestions.length) {
            showLevelComplete();
            return;
        }

        const q = currentQuestions[currentQIndex];
        const container = document.getElementById('options-area');
        container.innerHTML = '';
        
        // Set Text
        document.getElementById('q-text').innerText = `${currentQIndex + 1}. ${q.q}`;
        document.getElementById('q-image').innerText = q.type === 'img' ? 'üñºÔ∏è' : '‚ùì'; // Simple icon, could be dynamic

        // Shuffle Options
        const shuffledOpts = [...q.opts].sort(() => Math.random() - 0.5);

        shuffledOpts.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerHTML = `<span class="option-emoji">${opt.i}</span>${opt.t}`;
            btn.onclick = () => checkAnswer(opt.t, q.ans);
            container.appendChild(btn);
        });

        // Auto read for fun (optional)
        // speak(q.q); 
    }

    function checkAnswer(selected, correct) {
        const modal = document.getElementById('feedback-modal');
        const overlay = document.getElementById('overlay');
        const title = document.getElementById('fb-title');
        const msg = document.getElementById('fb-msg');
        const emoji = document.getElementById('fb-emoji');

        modal.style.display = 'block';
        overlay.style.display = 'block';

        if (selected === correct) {
            // Correct
            title.innerText = "Correct! üéâ";
            title.style.color = "#2ecc71";
            msg.innerText = `Yes! It is ${correct}.`;
            emoji.innerText = "üëç";
            modal.style.borderColor = "#2ecc71";
            score += 10;
            speak("Correct! Good job.");
            
            // Check for stars
            if (score % 50 === 0) stars++;
        } else {
            // Wrong
            title.innerText = "Oops! üòÖ";
            title.style.color = "#e74c3c";
            msg.innerText = `The correct answer was ${correct}.`;
            emoji.innerText = "ü§î";
            modal.style.borderColor = "#e74c3c";
            speak("Oh no, try again next time.");
        }
        updateUI();
    }

    function nextQuestion() {
        document.getElementById('feedback-modal').style.display = 'none';
        document.getElementById('overlay').style.display = 'none';
        currentQIndex++;
        loadQuestion();
    }

    function updateUI() {
        document.getElementById('score').innerText = score;
        document.getElementById('star-count').innerText = stars;
        document.getElementById('q-left').innerText = (currentQuestions.length - currentQIndex);
    }

    function showLevelComplete() {
        const modal = document.getElementById('feedback-modal');
        const overlay = document.getElementById('overlay');
        modal.style.display = 'block';
        overlay.style.display = 'block';
        
        document.getElementById('fb-title').innerText = "Level Complete! üèÜ";
        document.getElementById('fb-msg').innerText = "You are a Nutrition Master! Try the next level?";
        document.getElementById('fb-emoji').innerText = "üåü";
        
        // Change button behavior to stay or reset
        const nextBtn = document.querySelector('.next-btn');
        nextBtn.innerText = "Close";
        nextBtn.onclick = () => {
             modal.style.display = 'none';
             overlay.style.display = 'none';
             nextBtn.innerText = "Next Question ‚û°";
             nextBtn.onclick = nextQuestion; // Reset handler
        };
    }

    function readQuestion() {
        const text = currentQuestions[currentQIndex].q;
        speak(text);
    }

    function speak(text) {
        if ('speechSynthesis' in window) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.pitch = 1.2; // Higher pitch for kids
            utterance.rate = 0.9;  // Slightly slower
            window.speechSynthesis.speak(utterance);
        }
    }
</script>

</body>
</html>