<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Math Master Class 1 - Super Fun Learning!</title>
    <meta name="description" content="A complete Math learning game for Class 1 students. Learn numbers, shapes, addition, time, and money through play!">
    <style>
        :root {
            --primary: #FFD93D; /* Yellow */
            --secondary: #6BCB77; /* Green */
            --accent: #4D96FF; /* Blue */
            --danger: #FF6B6B; /* Red/Orange */
            --text: #2C3E50;
            --bg: #F0F4F8;
            --font-main: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg);
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            color: var(--text);
        }

        /* --- UI COMPONENTS --- */
        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            padding: 20px;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: flex;
        }

        h1 {
            color: var(--accent);
            text-shadow: 2px 2px 0px white;
            font-size: 2.5rem;
            text-align: center;
            margin-bottom: 20px;
        }

        h2 {
            color: var(--text);
            margin-bottom: 15px;
            text-align: center;
        }

        .btn {
            background: white;
            border: 4px solid var(--text);
            border-radius: 20px;
            padding: 15px 30px;
            font-size: 1.5rem;
            font-weight: bold;
            font-family: var(--font-main);
            margin: 10px;
            cursor: pointer;
            box-shadow: 0 6px 0 var(--text);
            transition: transform 0.1s, box-shadow 0.1s;
            width: 80%;
            max-width: 400px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .btn:active {
            transform: translateY(6px);
            box-shadow: 0 0 0 var(--text);
        }

        .btn-yellow { background: var(--primary); color: #333; }
        .btn-green { background: var(--secondary); color: white; border-color: #2e6b35; box-shadow: 0 6px 0 #2e6b35; }
        .btn-blue { background: var(--accent); color: white; border-color: #1a5bb8; box-shadow: 0 6px 0 #1a5bb8; }
        .btn-red { background: var(--danger); color: white; border-color: #b82e2e; box-shadow: 0 6px 0 #b82e2e; }

        /* --- GAME HUD --- */
        .hud {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 600px;
            padding: 10px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .stat-box {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* --- QUESTION AREA --- */
        .question-card {
            background: white;
            border-radius: 25px;
            padding: 20px;
            width: 100%;
            max-width: 600px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            margin-bottom: 20px;
            position: relative;
        }

        .q-text {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 20px;
            line-height: 1.3;
        }

        .visual-area {
            font-size: 4rem;
            margin: 10px 0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            width: 100%;
            max-width: 600px;
        }

        /* --- FEEDBACK --- */
        .feedback-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .feedback-msg {
            font-size: 3rem;
            color: white;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }

        /* --- CANVAS/SVG STYLES --- */
        .clock-face {
            width: 150px;
            height: 150px;
            border: 8px solid var(--text);
            border-radius: 50%;
            position: relative;
            background: white;
        }
        .hand {
            position: absolute;
            bottom: 50%;
            left: 50%;
            background: var(--text);
            transform-origin: bottom center;
            border-radius: 5px;
        }
        .hour-hand { width: 6px; height: 40px; background: var(--danger); }
        .min-hand { width: 4px; height: 60px; background: var(--accent); }
        .center-dot {
            width: 12px; height: 12px; background: var(--text);
            border-radius: 50%; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
        }

        /* --- ANIMATIONS --- */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { from { transform: scale(0.5); } to { transform: scale(1); } }
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } 100% { transform: translateX(0); } }

        /* --- UTILS --- */
        .shape-box { width: 60px; height: 60px; display: inline-block; margin: 5px; }
        .shape-circle { background: var(--danger); border-radius: 50%; }
        .shape-square { background: var(--accent); }
        .shape-triangle { 
            width: 0; height: 0; 
            border-left: 30px solid transparent; border-right: 30px solid transparent; 
            border-bottom: 60px solid var(--secondary); background: transparent; 
        }
        
        .money-note {
            display: inline-block;
            padding: 5px 10px;
            background: #85bb65;
            color: white;
            border: 2px dashed white;
            font-size: 1.2rem;
            margin: 5px;
            border-radius: 4px;
        }

        /* PROGRESS BAR */
        .progress-container {
            width: 100%;
            height: 10px;
            background: #ddd;
            border-radius: 5px;
            margin-top: 10px;
            max-width: 600px;
        }
        .progress-fill {
            height: 100%;
            background: var(--secondary);
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s;
        }

    </style>
</head>
<body>

    <div id="screen-home" class="screen active">
        <h1>üéì Math Master<br><span style="font-size:0.6em; color:var(--text)">Class 1</span></h1>
        
        <div class="btn btn-yellow" onclick="startGame('puzzle')">üß© Puzzles (Visual)</div>
        <div class="btn btn-blue" onclick="startGame('mind')">üß† Mind Games (Logic)</div>
        <div class="btn btn-red" onclick="startGame('mega')">üöÄ MEGA MODE (200 Qs)</div>
        
        <div style="margin-top: 20px; font-size: 0.9rem; color: #666;">
            Covers Numbers, Shapes, Time, Money & More!
        </div>
    </div>

    <div id="screen-game" class="screen">
        <div class="hud">
            <div class="stat-box">‚úÖ <span id="score-val">0</span></div>
            <div class="stat-box">‚ùå <span id="wrong-val">0</span></div>
            <div class="stat-box">üéØ <span id="q-count">1/20</span></div>
        </div>
        
        <div class="progress-container">
            <div id="progress-bar" class="progress-fill"></div>
        </div>

        <div class="question-card" id="q-card">
            <div class="q-text" id="q-text">Loading...</div>
            <div class="visual-area" id="q-visual"></div>
        </div>

        <div class="options-grid" id="options-area">
            </div>

        <div style="margin-top: 20px;">
            <button class="btn btn-yellow" style="width: auto; padding: 10px 20px; font-size: 1rem;" onclick="goHome()">üè† Exit</button>
        </div>
    </div>

    <div id="screen-result" class="screen">
        <h1 id="result-title">Good Job!</h1>
        <div style="font-size: 5rem; margin: 20px;">üèÜ</div>
        <h2>Score: <span id="final-score">0</span>%</h2>
        <p id="result-msg">You are learning fast!</p>
        
        <div class="btn btn-green" onclick="goHome()">Play Again</div>
    </div>

    <div id="feedback-overlay" class="feedback-overlay">
        <div class="feedback-msg" id="feedback-text">Correct!</div>
        <div style="font-size: 4rem;" id="feedback-emoji">üéâ</div>
    </div>

    <script>
        // --- GAME STATE ---
        const state = {
            mode: null,
            questions: [],
            currentIndex: 0,
            score: 0,
            wrong: 0,
            totalQuestions: 0
        };

        // --- AUDIO ENGINE (No External Files) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(500, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            } else if (type === 'wrong') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(200, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.3);
            } else if (type === 'win') {
                // Simple Arpeggio
                [440, 554, 659, 880].forEach((freq, i) => {
                    setTimeout(() => {
                        const o = audioCtx.createOscillator();
                        const g = audioCtx.createGain();
                        o.connect(g);
                        g.connect(audioCtx.destination);
                        o.frequency.value = freq;
                        g.gain.setValueAtTime(0.2, audioCtx.currentTime);
                        g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                        o.start();
                        o.stop(audioCtx.currentTime + 0.5);
                    }, i * 150);
                });
            }
        }

        // --- UTILITIES ---
        const rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        const pick = (arr) => arr[Math.floor(Math.random() * arr.length)];
        const shuffle = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        };

        // --- QUESTION GENERATORS (SYLLABUS) ---

        // 1. Numbers & Names
        const numNames = ["One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
                          "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen","Twenty"];
        function genNumName() {
            let n = rand(1, 20);
            let q = `What is the name of <b>${n}</b>?`;
            let ans = numNames[n-1];
            let opts = shuffle([ans, numNames[rand(0,19)], numNames[rand(0,19)], numNames[rand(0,19)]]);
            return { t: 'Number Names', q, v: '', ans, opts: [...new Set(opts)] }; // Set removes dupes
        }

        // 2. Counting
        const fruits = ['üçé','üçå','üçá','üçì','üçä','üçâ'];
        function genCounting() {
            let count = rand(3, 12);
            let fruit = pick(fruits);
            let visual = '';
            for(let i=0; i<count; i++) visual += fruit + ' ';
            let q = "Count the fruits!";
            let opts = shuffle([count, count+1, count-1, count+2]);
            return { t: 'Counting', q, v: visual, ans: count, opts };
        }

        // 3. Comparison
        function genCompare() {
            let a = rand(1, 20);
            let b = rand(1, 20);
            while(a === b) b = rand(1, 20);
            let q = `Which number is <b>${a > b ? 'BIGGER' : 'SMALLER'}</b>?`;
            let ans = a > b ? (a > b ? a : b) : (a < b ? a : b); // Logic handles the question text
            // Wait, simpler:
            let type = rand(0, 1) ? 'BIGGER' : 'SMALLER';
            q = `Which is <b>${type}</b>?`;
            ans = type === 'BIGGER' ? Math.max(a, b) : Math.min(a, b);
            
            return { t: 'Comparison', q, v: `<div style="font-size:3rem">${a} &nbsp; vs &nbsp; ${b}</div>`, ans, opts: [a, b] };
        }

        // 4. Addition / Subtraction
        function genMath(type) {
            if(type === 'add') {
                let a = rand(1, 10);
                let b = rand(1, 9);
                return { t: 'Addition', q: `${a} + ${b} = ?`, v: '', ans: a+b, opts: shuffle([a+b, a+b+1, a+b-1, a+b+2]) };
            } else {
                let a = rand(5, 15);
                let b = rand(1, a);
                return { t: 'Subtraction', q: `${a} - ${b} = ?`, v: '', ans: a-b, opts: shuffle([a-b, a-b+1, a-b-1, a-b+2]) };
            }
        }

        // 5. Shapes
        function genShape() {
            const shapes = [
                { name: 'Circle', html: '<div class="shape-box shape-circle"></div>' },
                { name: 'Square', html: '<div class="shape-box shape-square"></div>' },
                { name: 'Triangle', html: '<div class="shape-box shape-triangle"></div>' }
            ];
            let correct = pick(shapes);
            let q = `Find the <b>${correct.name}</b>!`;
            // Options will be the HTML strings
            let opts = shapes.map(s => s.html); // Must check click handling for this
            // To make it simple for the engine, we will pass names as values but render HTML
            return { 
                t: 'Shapes', 
                q, 
                v: '', 
                ans: correct.name, 
                opts: shapes.map(s => s.name),
                renderAs: 'custom_shape' // flag to renderer
            };
        }

        // 6. Time (Canvas helper later)
        function genTime() {
            let hour = rand(1, 12);
            let isHalf = Math.random() > 0.5;
            let min = isHalf ? 30 : 0;
            let timeStr = `${hour}:${min === 0 ? '00' : '30'}`;
            let q = "What time is it?";
            
            // Build visual clock data to pass
            return { 
                t: 'Time', 
                q, 
                v: 'CLOCK', // special flag
                clockData: { h: hour, m: min },
                ans: timeStr, 
                opts: shuffle([
                    timeStr, 
                    `${hour === 12 ? 1 : hour+1}:${min === 0 ? '00' : '30'}`, 
                    `${hour}:${min === 0 ? '30' : '00'}`,
                    `${rand(1,12)}:00`
                ]) 
            };
        }

        // 7. Money
        function genMoney() {
            let notes = [1, 2, 5, 10, 20];
            let a = pick(notes);
            let b = pick(notes);
            let total = a + b;
            let q = "How much money total?";
            let visual = `<span class="money-note">‚Çπ${a}</span> + <span class="money-note">‚Çπ${b}</span>`;
            return { t: 'Money', q, v: visual, ans: `‚Çπ${total}`, opts: shuffle([`‚Çπ${total}`, `‚Çπ${total+1}`, `‚Çπ${total+5}`, `‚Çπ${total-1}`]) };
        }

        // 8. Pattern
        function genPattern() {
            let items = ['üîµ', 'üî¥', '‚≠ê'];
            let pType = rand(0, 1); // 0 = ABAB, 1 = AAB
            let a = items[0], b = items[1];
            let seq = "", ans = "";
            
            if(pType === 0) {
                seq = `${a} ${b} ${a} ${b} ${a} ?`;
                ans = b;
            } else {
                seq = `${a} ${a} ${b} ${a} ${a} ?`;
                ans = b;
            }
            return { t: 'Pattern', q: "Complete the pattern:", v: `<div style='font-size:3rem'>${seq}</div>`, ans, opts: shuffle(['üîµ', 'üî¥', '‚≠ê']) };
        }

        // 9. Logic (Before/After)
        function genLogic() {
            let n = rand(5, 95);
            let type = rand(0, 2); // 0: Before, 1: After, 2: Odd/Even
            if(type === 0) {
                return { t: 'Logic', q: `What comes <b>BEFORE</b> ${n}?`, v: `_ , ${n}`, ans: n-1, opts: shuffle([n-1, n+1, n+2, n-2]) };
            } else if (type === 1) {
                return { t: 'Logic', q: `What comes <b>AFTER</b> ${n}?`, v: `${n} , _`, ans: n+1, opts: shuffle([n+1, n-1, n+2, n-2]) };
            } else {
                let isEven = n % 2 === 0;
                return { t: 'Logic', q: `Is <b>${n}</b> Odd or Even?`, v: '', ans: isEven ? "Even" : "Odd", opts: ["Even", "Odd"] };
            }
        }

        // --- QUESTION BANK BUILDER ---
        function generateQuestions(mode) {
            let qList = [];
            let count = (mode === 'mega') ? 200 : (mode === 'puzzle' ? 20 : 30);
            
            for(let i=0; i<count; i++) {
                let dice;
                if(mode === 'puzzle') {
                    // Visual stuff
                    dice = rand(1, 4); 
                    if(dice===1) qList.push(genCounting());
                    if(dice===2) qList.push(genShape());
                    if(dice===3) qList.push(genTime());
                    if(dice===4) qList.push(genPattern());
                } else if (mode === 'mind') {
                    // Logic stuff
                    dice = rand(1, 4);
                    if(dice===1) qList.push(genMath('add'));
                    if(dice===2) qList.push(genMath('sub'));
                    if(dice===3) qList.push(genCompare());
                    if(dice===4) qList.push(genLogic());
                } else {
                    // MEGA MIX (All topics)
                    dice = rand(1, 9);
                    if(dice===1) qList.push(genNumName());
                    if(dice===2) qList.push(genCounting());
                    if(dice===3) qList.push(genCompare());
                    if(dice===4) qList.push(genMath('add'));
                    if(dice===5) qList.push(genMath('sub'));
                    if(dice===6) qList.push(genShape());
                    if(dice===7) qList.push(genTime());
                    if(dice===8) qList.push(genMoney());
                    if(dice===9) qList.push(genLogic());
                }
            }
            return qList;
        }

        // --- GAME ENGINE ---
        function startGame(mode) {
            state.mode = mode;
            state.score = 0;
            state.wrong = 0;
            state.currentIndex = 0;
            state.questions = generateQuestions(mode);
            state.totalQuestions = state.questions.length;

            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-game').classList.add('active');
            
            updateHUD();
            loadQuestion();
        }

        function loadQuestion() {
            const q = state.questions[state.currentIndex];
            const qText = document.getElementById('q-text');
            const qVisual = document.getElementById('q-visual');
            const optsArea = document.getElementById('options-area');

            // Set Text
            qText.innerHTML = `<small style="color:#888; display:block; font-size:1rem">${q.t}</small>${q.q}`;
            qVisual.innerHTML = '';

            // Set Visuals
            if(q.v === 'CLOCK') {
                qVisual.appendChild(createClock(q.clockData.h, q.clockData.m));
            } else {
                qVisual.innerHTML = q.v;
            }

            // Set Options
            optsArea.innerHTML = '';
            // Handle shape custom rendering vs text buttons
            let isShape = (q.renderAs === 'custom_shape');
            
            q.opts.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = isShape ? 'btn' : 'btn btn-blue';
                
                if(isShape) {
                    // Find the HTML for this shape name
                    if(opt === 'Circle') btn.innerHTML = '<div class="shape-box shape-circle"></div>';
                    if(opt === 'Square') btn.innerHTML = '<div class="shape-box shape-square"></div>';
                    if(opt === 'Triangle') btn.innerHTML = '<div class="shape-box shape-triangle"></div>';
                    // Reset styling for shape container
                    btn.style.background = 'transparent';
                    btn.style.border = 'none';
                    btn.style.boxShadow = 'none';
                } else {
                    btn.innerText = opt;
                }

                btn.onclick = () => checkAnswer(opt, q.ans);
                optsArea.appendChild(btn);
            });
            
            // Layout tweak for shapes to fit row
            if(isShape) optsArea.style.display = 'flex';
            else optsArea.style.display = 'grid';
        }

        function createClock(h, m) {
            const canvas = document.createElement('div');
            canvas.className = 'clock-face';
            
            // Calculate rotation
            // Hour hand: (h * 30) + (m * 0.5)
            // Min hand: m * 6
            const hDeg = (h * 30) + (m * 0.5);
            const mDeg = m * 6;

            const hourHand = document.createElement('div');
            hourHand.className = 'hand hour-hand';
            hourHand.style.transform = `translateX(-50%) rotate(${hDeg}deg)`;
            
            const minHand = document.createElement('div');
            minHand.className = 'hand min-hand';
            minHand.style.transform = `translateX(-50%) rotate(${mDeg}deg)`;

            const dot = document.createElement('div');
            dot.className = 'center-dot';

            canvas.appendChild(hourHand);
            canvas.appendChild(minHand);
            canvas.appendChild(dot);
            return canvas;
        }

        function checkAnswer(selected, correct) {
            let isCorrect = (selected == correct);
            
            const overlay = document.getElementById('feedback-overlay');
            const txt = document.getElementById('feedback-text');
            const emoji = document.getElementById('feedback-emoji');

            overlay.style.display = 'flex';

            if(isCorrect) {
                state.score++;
                txt.innerText = pick(["Good Job!", "Super!", "Correct!", "Awesome!"]);
                txt.style.color = "#6BCB77";
                emoji.innerText = pick(["üåü", "üçé", "üéà", "üèÜ"]);
                playSound('correct');
            } else {
                state.wrong++;
                txt.innerText = pick(["Try Again!", "Oops!", "Close!"]);
                txt.style.color = "#FF6B6B";
                emoji.innerText = "ü§î";
                playSound('wrong');
            }

            updateHUD();

            // Wait 1 second then next
            setTimeout(() => {
                overlay.style.display = 'none';
                nextQuestion();
            }, 1200);
        }

        function nextQuestion() {
            state.currentIndex++;
            if(state.currentIndex >= state.totalQuestions) {
                endGame();
            } else {
                loadQuestion();
            }
        }

        function updateHUD() {
            document.getElementById('score-val').innerText = state.score;
            document.getElementById('wrong-val').innerText = state.wrong;
            document.getElementById('q-count').innerText = `${state.currentIndex + 1} / ${state.totalQuestions}`;
            
            let pct = ((state.currentIndex) / state.totalQuestions) * 100;
            document.getElementById('progress-bar').style.width = pct + "%";
        }

        function endGame() {
            document.getElementById('screen-game').classList.remove('active');
            document.getElementById('screen-result').classList.add('active');
            playSound('win');

            let percentage = Math.round((state.score / state.totalQuestions) * 100);
            document.getElementById('final-score').innerText = percentage;

            let title = document.getElementById('result-title');
            let msg = document.getElementById('result-msg');

            if(percentage > 90) {
                title.innerText = "Math Star! ‚≠ê";
                msg.innerText = "You are a genius!";
            } else if (percentage > 70) {
                title.innerText = "Super Learner! üèÜ";
                msg.innerText = "Great job, keep it up!";
            } else {
                title.innerText = "Good Effort! üëç";
                msg.innerText = "Practice makes perfect!";
            }
        }

        function goHome() {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-home').classList.add('active');
        }

    </script>
</body>
</html>